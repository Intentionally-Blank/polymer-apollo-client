<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<script src="build/apollo-client.js"></script>

<!--
# GraphQL Client

You can set up a connection to you graphql-client backend with `graphql-client`.

## Installation

### Include the build/apollo-client.js in your website for a default setup.

```html
<script src="bower_components/apollo-client/build/apollo-client.js"></script>
```

### Create a single instance of the graphql-client.html

```html
<link rel="import" href="apollo-client/graphql-client.html" />
```

```html
<graphql-client config='{ "uri": "https://graphql.endpoint/graphql" }'></graphql-client>
```

This will (by default) create an instance of Apollo Client with a [BatchedNetworkInterface](http://dev.apollodata.com/core/network.html#BatchingExample).

## Custom Apollo Client

You can omit this html element completely if you make sure `window.Apollo.client` and `window.Apollo.gql` is available.

- `window.Apollo.client` an instance of ApolloClient
- `window.Apollo.gql` an export of `graphql-tag`

For an example how to set this up, take a look at [apollo-client.js](apollo-client.js).

@group Apollo Client
@demo demo/index.html
-->
<dom-module id="graphql-client">
  <template>
    <style>
      :host {
        display: none;
      }
    </style>
  </template>
  <script>
    const CLIENT_NAME_DEFAULT = 'default';
    class GraphqlClient extends Polymer.Element {
      static get is() { return 'graphql-client' }
      static get properties() {
        return {
          config: Object,
          clientName: {
            type: String,
            value: CLIENT_NAME_DEFAULT
          }
        }
      }

      connectedCallback() {
        super.connectedCallback()

        window.Apollo.namedClient[this.clientName] = window.Apollo.init(this.config);

        if (this.clientName === CLIENT_NAME_DEFAULT) {
          window.Apollo.client = window.Apollo.namedClient[CLIENT_NAME_DEFAULT]
          window.__APOLLO_CLIENT__ = window.Apollo.client
        }
      }
    }
    customElements.define(GraphqlClient.is, GraphqlClient);
  </script>
</dom-module>
